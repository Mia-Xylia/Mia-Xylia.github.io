{
    "version": "https://jsonfeed.org/version/1",
    "title": "null • All posts by \"pytorch基础\" tag",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2025/03/26/computer-science/python/pytorch2/",
            "url": "http://example.com/2025/03/26/computer-science/python/pytorch2/",
            "title": "笔记：PyTorch(2)",
            "date_published": "2025-03-25T16:00:00.000Z",
            "content_html": "<h1 id=\"神经网络\"><a class=\"markdownIt-Anchor\" href=\"#神经网络\">#</a> 神经网络</h1>\n<h2 id=\"神经网络的基本骨架-nnmodule\"><a class=\"markdownIt-Anchor\" href=\"#神经网络的基本骨架-nnmodule\">#</a> 神经网络的基本骨架  nn.Module</h2>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torch</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">sympy</span> <span class=\"string\">import</span> <span class=\"string\">xring</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch</span> <span class=\"string\">import</span> <span class=\"string\">nn</span></span><br><span class=\"line\"><span class=\"attr\">class Xylia(nn.Module):</span></span><br><span class=\"line\">    <span class=\"attr\">def __init__(self):</span></span><br><span class=\"line\">        <span class=\"string\">super().__init__()</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">forward(self,</span> <span class=\"attr\">input):</span></span><br><span class=\"line\">        <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">input+1</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">output</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">xylia</span>  <span class=\"string\">=</span> <span class=\"string\">Xylia()</span></span><br><span class=\"line\"><span class=\"string\">x</span> <span class=\"string\">=</span> <span class=\"string\">torch.tensor(1.0)</span></span><br><span class=\"line\"><span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">xylia(x)</span></span><br><span class=\"line\"><span class=\"string\">print(output)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"卷积层-convolution-layers\"><a class=\"markdownIt-Anchor\" href=\"#卷积层-convolution-layers\">#</a> 卷积层  Convolution Layers</h2>\n<ul>\n<li>nn.Conv2d<br>\n+++ 部分官方文档</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride=1, padding=0, dilation=1, groups=1, bias=True, padding_mode=&#x27;zeros&#x27;)</span><br></pre></td></tr></table></figure>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3ZkdW1vdWxpbi9jb252X2FyaXRobWV0aWMvYmxvYi9tYXN0ZXIvUkVBRE1FLm1k\">link</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">in_channels (int) – Number of channels in the input image</span><br><span class=\"line\"></span><br><span class=\"line\">out_channels (int) – Number of channels produced by the convolution</span><br><span class=\"line\"></span><br><span class=\"line\">kernel_size (int or tuple) – Size of the convolving kernel</span><br><span class=\"line\"></span><br><span class=\"line\">stride (int or tuple, optional) – Stride of the convolution. Default: 1</span><br><span class=\"line\"></span><br><span class=\"line\">padding (int or tuple, optional) – Zero-padding added to both sides of the input. Default: 0</span><br><span class=\"line\"></span><br><span class=\"line\">padding_mode (string, optional) – &#x27;zeros&#x27;, &#x27;reflect&#x27;, &#x27;replicate&#x27; or &#x27;circular&#x27;. Default: &#x27;zeros&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">dilation (int or tuple, optional) – Spacing between kernel elements. Default: 1</span><br><span class=\"line\"></span><br><span class=\"line\">groups (int, optional) – Number of blocked connections from input channels to output channels. Default: 1</span><br><span class=\"line\"></span><br><span class=\"line\">bias (bool, optional) – If True, adds a learnable bias to the output. Default: True</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>+++<br>\nOut_channel = 2 生成两个卷积核</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torch</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torchvision</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch</span> <span class=\"string\">import</span> <span class=\"string\">nn</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.data</span> <span class=\"string\">import</span> <span class=\"string\">DataLoader</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">nn_module</span> <span class=\"string\">import</span> <span class=\"string\">output</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">test_tb</span> <span class=\"string\">import</span> <span class=\"string\">writer</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataset</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(&quot;./data&quot;,train=False,transform=torchvision.transforms.ToTensor(),</span></span><br><span class=\"line\">                                       <span class=\"string\">download=True)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataloader</span> <span class=\"string\">=</span> <span class=\"string\">DataLoader(dataset,batch_size</span> <span class=\"string\">=</span> <span class=\"number\">64</span><span class=\"string\">)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">class Xylia(nn.Module):</span></span><br><span class=\"line\">    <span class=\"attr\">def __init__(self):</span></span><br><span class=\"line\">        <span class=\"string\">super(Xylia,</span> <span class=\"string\">self).__init__()</span></span><br><span class=\"line\">        <span class=\"string\">self.conv1</span> <span class=\"string\">=</span> <span class=\"string\">nn.Conv2d(in_channels=3,</span> <span class=\"string\">out_channels=6,</span> <span class=\"string\">kernel_size=3,stride=1,padding=0)</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">forward(self,x):</span></span><br><span class=\"line\">        <span class=\"string\">x</span> <span class=\"string\">=</span> <span class=\"string\">self.conv1(x)</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">x</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">xylia</span> <span class=\"string\">=</span> <span class=\"string\">Xylia()</span></span><br><span class=\"line\"><span class=\"comment\"># print(xylia)</span></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;./log&quot;)</span></span><br><span class=\"line\"><span class=\"string\">step</span> <span class=\"string\">=</span> <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"attr\">for data in dataloader:</span></span><br><span class=\"line\">    <span class=\"string\">imgs,targets</span> <span class=\"string\">=</span> <span class=\"string\">data</span></span><br><span class=\"line\">    <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">xylia(imgs)</span></span><br><span class=\"line\">    <span class=\"string\">print(imgs.shape)</span></span><br><span class=\"line\">    <span class=\"string\">print(output.shape)</span></span><br><span class=\"line\">    <span class=\"comment\"># torch.Size([64, 3, 32, 32])</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_images(&quot;input&quot;,imgs,step)</span></span><br><span class=\"line\">    <span class=\"comment\"># torch.Size([64, 6, 30, 30])</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">torch.reshape(output,(-1,3,30,30))</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_images(&quot;output&quot;,output,step)</span></span><br><span class=\"line\">    <span class=\"string\">step</span> <span class=\"string\">+=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"池化层-pooling-layers\"><a class=\"markdownIt-Anchor\" href=\"#池化层-pooling-layers\">#</a> 池化层  Pooling layers</h2>\n<ul>\n<li>nn.MaxPool2d<br>\n+++ 部分官方文档</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">kernel_size – the size of the window to take a max over</span><br><span class=\"line\"></span><br><span class=\"line\">stride – the stride of the window. Default value is kernel_size</span><br><span class=\"line\"></span><br><span class=\"line\">padding – implicit zero padding to be added on both sides</span><br><span class=\"line\"></span><br><span class=\"line\">dilation – a parameter that controls the stride of elements in the window</span><br><span class=\"line\"></span><br><span class=\"line\">return_indices – if True, will return the max indices along with the outputs. Useful for torch.nn.MaxUnpool2d later</span><br><span class=\"line\"></span><br><span class=\"line\">ceil_mode – when True, will use ceil instead of floor to compute the output shape</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>+++</p>\n<p>dilation 空洞卷积，卷积核每两个数空一格<br>\n kernel_size = 3<br>\n 输入图像：5<em>5<br>\n 池化核 3</em>3<br>\nCeil_model = True   进行保留</p>\n<p>最大池化的作用：保留数据特征，数据量减少</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torch</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch</span> <span class=\"string\">import</span> <span class=\"string\">nn</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torchvision</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.data</span> <span class=\"string\">import</span> <span class=\"string\">DataLoader</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataset</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(&quot;./data&quot;,</span> <span class=\"string\">train=True,</span> <span class=\"string\">download=True,</span></span><br><span class=\"line\">                                       <span class=\"string\">transform=torchvision.transforms.ToTensor())</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataloader</span> <span class=\"string\">=</span> <span class=\"string\">DataLoader(dataset,</span> <span class=\"string\">batch_size=64)</span></span><br><span class=\"line\"><span class=\"comment\"># # 输入数据</span></span><br><span class=\"line\"><span class=\"comment\"># input = torch.tensor([[1,2,0,3,1],</span></span><br><span class=\"line\"><span class=\"comment\">#                       [0,1,2,3,1],</span></span><br><span class=\"line\"><span class=\"comment\">#                       [1,2,1,0,0],</span></span><br><span class=\"line\"><span class=\"comment\">#                       [5,2,3,1,1],</span></span><br><span class=\"line\"><span class=\"comment\">#                       [2,1,0,1,1]],dtype=torch.float32)# 二维矩阵</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># input = torch.reshape(input,(-1,1,5,5))</span></span><br><span class=\"line\"><span class=\"comment\"># print(input.shape)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">class Xylia(nn.Module):</span></span><br><span class=\"line\">    <span class=\"attr\">def __init__(self):</span></span><br><span class=\"line\">        <span class=\"string\">super(Xylia,</span> <span class=\"string\">self).__init__()</span></span><br><span class=\"line\">        <span class=\"string\">self.maxpool1</span> <span class=\"string\">=</span> <span class=\"string\">nn.MaxPool2d(kernel_size=3,</span> <span class=\"string\">ceil_mode=False)</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">forward(self,</span> <span class=\"attr\">input):</span></span><br><span class=\"line\">        <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">self.maxpool1(input)</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">output</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">xylia</span> <span class=\"string\">=</span> <span class=\"string\">Xylia()</span></span><br><span class=\"line\"><span class=\"comment\"># output = xylia(input)</span></span><br><span class=\"line\"><span class=\"comment\"># print(output)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;./logs_maxpoll&quot;)</span></span><br><span class=\"line\"><span class=\"string\">step</span> <span class=\"string\">=</span> <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">for data in dataloader:</span></span><br><span class=\"line\">    <span class=\"string\">imgs,targets</span> <span class=\"string\">=</span> <span class=\"string\">data</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_images(&quot;input&quot;,</span> <span class=\"string\">imgs,</span> <span class=\"string\">step)</span></span><br><span class=\"line\">    <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">xylia(imgs)</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_images(&quot;output&quot;,</span> <span class=\"string\">output,</span> <span class=\"string\">step)</span></span><br><span class=\"line\">    <span class=\"string\">step</span> <span class=\"string\">+=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"padding-layers\"><a class=\"markdownIt-Anchor\" href=\"#padding-layers\">#</a> Padding Layers</h2>\n<ul>\n<li>nn.ZeroPad2d<br>\n 用 0 填充</li>\n<li>nn.ConstatPad2d<br>\n 用常数填充</li>\n</ul>\n<h2 id=\"非线性激活-no-linear-activations\"><a class=\"markdownIt-Anchor\" href=\"#非线性激活-no-linear-activations\">#</a> 非线性激活  No-linear Activations</h2>\n<ul>\n<li>nn.Relu  截断<br>\n input&gt;0 output = input<br>\ninput&lt;0 output = 0</li>\n</ul>\n<p>+++inplace<br>\ninput = -1<br>\nPelu(input,inplace = True)<br>\ninput =0</p>\n<p>input = -1<br>\nPelu(input,inplace = False)<br>\ninput =-1<br>\noutput = 0<br>\n+++</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span>  <span class=\"string\">torch</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch</span> <span class=\"string\">import</span> <span class=\"string\">nn</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">input</span> <span class=\"string\">=</span> <span class=\"string\">torch.tensor([[1,-0.5],</span></span><br><span class=\"line\">                     [<span class=\"number\">-1</span>,<span class=\"number\">3</span>]<span class=\"string\">])</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">input</span> <span class=\"string\">=</span> <span class=\"string\">torch.reshape(input,(-1,1,2,2))</span></span><br><span class=\"line\"><span class=\"string\">print(input.shape)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">class Xylia(nn.Module):</span></span><br><span class=\"line\">    <span class=\"attr\">def __init__(self):</span></span><br><span class=\"line\">        <span class=\"string\">super(Xylia,</span> <span class=\"string\">self).__init__()</span></span><br><span class=\"line\">        <span class=\"string\">self.relu1</span> <span class=\"string\">=</span> <span class=\"string\">nn.ReLU()</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">forward(self,</span> <span class=\"attr\">input):</span></span><br><span class=\"line\">        <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">self.relu1(input)</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">output</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">xylia</span> <span class=\"string\">=</span> <span class=\"string\">Xylia()</span></span><br><span class=\"line\"><span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">xylia(input)</span></span><br><span class=\"line\"><span class=\"string\">print(output)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>nn.Sigmoid</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span>  <span class=\"string\">torch</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torchvision</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch</span> <span class=\"string\">import</span> <span class=\"string\">nn</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.data</span> <span class=\"string\">import</span> <span class=\"string\">DataLoader</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">nn_conv2</span> <span class=\"string\">import</span> <span class=\"string\">dataloader</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">input</span> <span class=\"string\">=</span> <span class=\"string\">torch.tensor([[1,-0.5],</span></span><br><span class=\"line\">                     [<span class=\"number\">-1</span>,<span class=\"number\">3</span>]<span class=\"string\">])</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">input</span> <span class=\"string\">=</span> <span class=\"string\">torch.reshape(input,(-1,1,2,2))</span></span><br><span class=\"line\"><span class=\"string\">print(input.shape)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataset</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(&quot;./data&quot;,</span> <span class=\"string\">train=True,</span> <span class=\"string\">download=True,</span></span><br><span class=\"line\">                                       <span class=\"string\">transform=torchvision.transforms.ToTensor())</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataloader</span> <span class=\"string\">=</span> <span class=\"string\">DataLoader(dataset,batch_size=64)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">class Xylia(nn.Module):</span></span><br><span class=\"line\">    <span class=\"attr\">def __init__(self):</span></span><br><span class=\"line\">        <span class=\"string\">super(Xylia,</span> <span class=\"string\">self).__init__()</span></span><br><span class=\"line\">        <span class=\"string\">self.relu1</span> <span class=\"string\">=</span> <span class=\"string\">nn.ReLU()</span></span><br><span class=\"line\">        <span class=\"string\">self.sigmoid1</span> <span class=\"string\">=</span> <span class=\"string\">nn.Sigmoid()</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">forward(self,</span> <span class=\"attr\">input):</span></span><br><span class=\"line\">        <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">self.sigmoid1(input)</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">output</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">xylia</span> <span class=\"string\">=</span> <span class=\"string\">Xylia()</span></span><br><span class=\"line\"><span class=\"comment\"># output = xylia(input)</span></span><br><span class=\"line\"><span class=\"comment\"># print(output)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;./logs_sigmoid1&quot;)</span></span><br><span class=\"line\"><span class=\"string\">step</span> <span class=\"string\">=</span> <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"attr\">for data in dataloader:</span></span><br><span class=\"line\">    <span class=\"string\">imgs,</span> <span class=\"string\">targets</span> <span class=\"string\">=</span> <span class=\"string\">data</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_images(&quot;input&quot;,</span> <span class=\"string\">imgs,</span> <span class=\"string\">global_step=step)</span></span><br><span class=\"line\">    <span class=\"string\">outputs</span> <span class=\"string\">=</span> <span class=\"string\">xylia(imgs)</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_images(&quot;output&quot;,</span> <span class=\"string\">outputs,</span> <span class=\"string\">global_step=step)</span></span><br><span class=\"line\">    <span class=\"string\">step</span> <span class=\"string\">+=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"线性层及其他层介绍\"><a class=\"markdownIt-Anchor\" href=\"#线性层及其他层介绍\">#</a> 线性层及其他层介绍</h2>\n<ul>\n<li>Normalization Layer</li>\n<li>Recurrent Layers</li>\n<li>Transformer Layers</li>\n<li>Dropout Layers<br>\nnn.Dropout 防止过拟合</li>\n<li>Sparse Layers<br>\nnn.Embedding 自然语言</li>\n<li>Distance Functions</li>\n<li>Loss Functions</li>\n</ul>\n<h3 id=\"linaear-layers\"><a class=\"markdownIt-Anchor\" href=\"#linaear-layers\">#</a> Linaear Layers</h3>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torch</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torchvision</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch</span> <span class=\"string\">import</span> <span class=\"string\">nn</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.data</span> <span class=\"string\">import</span> <span class=\"string\">DataLoader</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataset</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(&quot;./data&quot;,</span> <span class=\"string\">train=False,</span> <span class=\"string\">download=True,</span></span><br><span class=\"line\">                                       <span class=\"string\">transform=torchvision.transforms.ToTensor())</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#数据集batch之后生下了16张图片，舍弃最后不满足的drop_last=True</span></span><br><span class=\"line\"><span class=\"string\">dataloader</span> <span class=\"string\">=</span> <span class=\"string\">DataLoader(dataset,</span> <span class=\"string\">batch_size=64,drop_last=True)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">class Xylia(nn.Module):</span></span><br><span class=\"line\">    <span class=\"attr\">def __init__(self):</span></span><br><span class=\"line\">        <span class=\"string\">super(Xylia,self).__init__()</span></span><br><span class=\"line\">        <span class=\"string\">self.Linear1</span> <span class=\"string\">=</span> <span class=\"string\">nn.Linear(196608,10)</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">forward(self,input):</span></span><br><span class=\"line\">        <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">self.Linear1(input)</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">output</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">xylia</span> <span class=\"string\">=</span> <span class=\"string\">Xylia()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">for data in dataloader:</span></span><br><span class=\"line\">    <span class=\"string\">imgs,targets</span> <span class=\"string\">=</span> <span class=\"string\">data</span></span><br><span class=\"line\">    <span class=\"string\">print(imgs.shape)</span></span><br><span class=\"line\">    <span class=\"comment\"># output = torch.reshape(imgs,(1,1,1,-1))</span></span><br><span class=\"line\">    <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">torch.flatten(imgs)</span></span><br><span class=\"line\">    <span class=\"string\">print(output.shape)</span></span><br><span class=\"line\">    <span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">xylia(output)</span></span><br><span class=\"line\">    <span class=\"string\">print(output.shape)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"搭建小实战和sequential的使用\"><a class=\"markdownIt-Anchor\" href=\"#搭建小实战和sequential的使用\">#</a> 搭建小实战和 Sequential 的使用</h2>\n<h1 id=\"土堆说卷积操作选看\"><a class=\"markdownIt-Anchor\" href=\"#土堆说卷积操作选看\">#</a> 土堆说卷积操作 (选看)</h1>\n<ul>\n<li>conv2D<br>\nstride = 1 时走一步</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torch</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torch.nn.functional</span> <span class=\"string\">as</span> <span class=\"string\">F</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输入数据</span></span><br><span class=\"line\"><span class=\"string\">input</span> <span class=\"string\">=</span> <span class=\"string\">torch.tensor([[1,2,0,3,1],</span></span><br><span class=\"line\">                      [<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">1</span>]<span class=\"string\">,</span></span><br><span class=\"line\">                      [<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>]<span class=\"string\">,</span></span><br><span class=\"line\">                      [<span class=\"number\">5</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">1</span>,<span class=\"number\">1</span>]<span class=\"string\">,</span></span><br><span class=\"line\">                      [<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">1</span>]<span class=\"string\">])#</span> <span class=\"string\">二维矩阵</span></span><br><span class=\"line\"><span class=\"comment\"># 卷积核</span></span><br><span class=\"line\"><span class=\"string\">kernel</span> <span class=\"string\">=</span> <span class=\"string\">torch.tensor([[1,2,1],</span></span><br><span class=\"line\">                       [<span class=\"number\">0</span>,<span class=\"number\">1</span>,<span class=\"number\">0</span>]<span class=\"string\">,</span></span><br><span class=\"line\">                       [<span class=\"number\">2</span>,<span class=\"number\">1</span>,<span class=\"number\">0</span>]<span class=\"string\">])</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 尺寸变换</span></span><br><span class=\"line\"><span class=\"string\">input</span> <span class=\"string\">=</span> <span class=\"string\">torch.reshape(input,(1,1,5,5))</span></span><br><span class=\"line\"><span class=\"string\">kernel</span> <span class=\"string\">=</span> <span class=\"string\">torch.reshape(kernel,(1,1,3,3))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># print(input.shape)</span></span><br><span class=\"line\"><span class=\"comment\"># print(kernel.shape)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">output</span> <span class=\"string\">=</span> <span class=\"string\">F.conv2d(input,kernel,stride=1)</span></span><br><span class=\"line\"><span class=\"string\">print(output)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">output2</span> <span class=\"string\">=</span> <span class=\"string\">F.conv2d(input,kernel,stride=2)</span></span><br><span class=\"line\"><span class=\"string\">print(output2)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>padding<br>\npadding = 1, 向外拓展一行 / 列</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">output3</span> <span class=\"string\">=</span> <span class=\"string\">F.conv2d(input,kernel,stride=1,padding=1)</span></span><br><span class=\"line\"><span class=\"string\">print(output3)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>",
            "tags": [
                "pytorch基础",
                "笔记"
            ]
        },
        {
            "id": "http://example.com/2025/03/25/computer-science/python/pytorch1/",
            "url": "http://example.com/2025/03/25/computer-science/python/pytorch1/",
            "title": "笔记：PyTorch(1)",
            "date_published": "2025-03-24T16:00:00.000Z",
            "content_html": "<h1 id=\"加载数据的方式\"><a class=\"markdownIt-Anchor\" href=\"#加载数据的方式\">#</a> 加载数据的方式</h1>\n<ul>\n<li>Dataset<br>\n 提供一种方式去获取数据及其 label<br>\n 如何获取每一个数据及其 label<br>\n 告诉我们总共有多少的数据</li>\n<li>Dataloader<br>\n 为后面网络提供不同的数据形式</li>\n</ul>\n<h1 id=\"使用dataset\"><a class=\"markdownIt-Anchor\" href=\"#使用dataset\">#</a> 使用 dataset</h1>\n<ul>\n<li>查看 dataset 的使用说明</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```jupyter</span> <span class=\"string\">notebook</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.data</span> <span class=\"string\">import</span> <span class=\"string\">Dataset</span></span><br><span class=\"line\"><span class=\"string\">help(Dataset)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>实战</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.data</span> <span class=\"string\">import</span> <span class=\"string\">Dataset</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">PIL</span> <span class=\"string\">import</span> <span class=\"string\">Image</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">os</span></span><br><span class=\"line\"><span class=\"attr\">class MyData(Dataset):</span></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">__init__(self,root_dir,lable_dir):</span></span><br><span class=\"line\">        <span class=\"string\">self.root_dir</span> <span class=\"string\">=</span> <span class=\"string\">root_dir</span></span><br><span class=\"line\">        <span class=\"string\">self.lable_dir</span> <span class=\"string\">=</span> <span class=\"string\">lable_dir</span></span><br><span class=\"line\">        <span class=\"string\">self.path</span> <span class=\"string\">=</span> <span class=\"string\">os.path.join(self.root_dir,self.lable_dir)</span></span><br><span class=\"line\">        <span class=\"string\">self.img_path</span> <span class=\"string\">=</span> <span class=\"string\">os.listdir(self.path)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">__getitem__(self,</span> <span class=\"attr\">index):</span></span><br><span class=\"line\">        <span class=\"string\">img_name</span> <span class=\"string\">=</span> <span class=\"string\">self.img_path[index]</span></span><br><span class=\"line\">        <span class=\"string\">img_item_path</span> <span class=\"string\">=</span> <span class=\"string\">os.path.join(self.root_dir,self.lable_dir,img_name)</span></span><br><span class=\"line\">        <span class=\"string\">img</span> <span class=\"string\">=</span> <span class=\"string\">Image.open(img_item_path)</span></span><br><span class=\"line\">        <span class=\"string\">label</span> <span class=\"string\">=</span> <span class=\"string\">self.lable_dir</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">img,</span> <span class=\"string\">label</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attr\">def __len__(self):</span></span><br><span class=\"line\">        <span class=\"string\">return</span> <span class=\"string\">len(self.img_path)</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">root_dir</span> <span class=\"string\">=</span> <span class=\"string\">r&#x27;dataset/train&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ants_lable_dir</span> <span class=\"string\">=</span> <span class=\"string\">&#x27;ants_image&#x27;</span></span><br><span class=\"line\"><span class=\"string\">bees_lable_dir</span> <span class=\"string\">=</span> <span class=\"string\">&#x27;bees_image&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ants_dataset</span> <span class=\"string\">=</span> <span class=\"string\">MyData(root_dir,ants_lable_dir)</span></span><br><span class=\"line\"><span class=\"string\">bees_dataset</span> <span class=\"string\">=</span> <span class=\"string\">MyData(root_dir,bees_lable_dir)</span></span><br><span class=\"line\"><span class=\"comment\"># 合并数据</span></span><br><span class=\"line\"><span class=\"string\">dataset</span> <span class=\"string\">=</span> <span class=\"string\">ants_dataset</span> <span class=\"string\">+</span> <span class=\"string\">bees_dataset</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看长度</span></span><br><span class=\"line\"><span class=\"string\">len(ants_lable_dir)</span></span><br><span class=\"line\"><span class=\"string\">len(bees_lable_dir)</span></span><br><span class=\"line\"><span class=\"string\">len(dataset)</span></span><br><span class=\"line\"><span class=\"string\">print(f&quot;一共有&#123;len(dataset)&#125;张图片&quot;)</span></span><br><span class=\"line\"><span class=\"comment\"># 展示图片</span></span><br><span class=\"line\"><span class=\"string\">x</span> <span class=\"string\">=</span> <span class=\"string\">input(&quot;请输入你想查询的图片编号&quot;)</span></span><br><span class=\"line\"><span class=\"string\">x</span> <span class=\"string\">=</span> <span class=\"string\">int(x)</span></span><br><span class=\"line\"><span class=\"string\">img,label</span> <span class=\"string\">=</span> <span class=\"string\">dataset[x]</span></span><br><span class=\"line\"><span class=\"string\">img.show()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"tensorboard的使用\"><a class=\"markdownIt-Anchor\" href=\"#tensorboard的使用\">#</a> TensorBoard 的使用</h2>\n<ul>\n<li>安装 tensorboard</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```终端</span></span><br><span class=\"line\"><span class=\"string\">pip</span> <span class=\"string\">install</span> <span class=\"string\">tensorboard</span></span><br><span class=\"line\"><span class=\"comment\"># logdir = 事件文件所在文件夹名</span></span><br><span class=\"line\"><span class=\"string\">tensorboard</span> <span class=\"string\">--logdir=log</span> <span class=\"string\">--port=6007</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"使用add_scalar\"><a class=\"markdownIt-Anchor\" href=\"#使用add_scalar\">#</a> 使用 add_scalar</h3>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;log&quot;)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># writer.add_image()</span></span><br><span class=\"line\"><span class=\"comment\"># y = 2x</span></span><br><span class=\"line\"><span class=\"attr\">for i in range(100):</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_scalar(tag=&quot;y=x&quot;,</span> <span class=\"string\">scalar_value=i,</span> <span class=\"string\">global_step=i)</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_scalar(tag=&quot;y=2x&quot;,</span> <span class=\"string\">scalar_value=2*i,</span> <span class=\"string\">global_step=i)#</span> <span class=\"string\">标题，数值（y轴），训练的步数（x轴）</span></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">```终端</span></span><br><span class=\"line\"><span class=\"string\">tensorboard</span> <span class=\"string\">--logdir=log</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"使用add_image\"><a class=\"markdownIt-Anchor\" href=\"#使用add_image\">#</a> 使用 add_image</h3>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python控制台</span></span><br><span class=\"line\"><span class=\"string\">image_path</span> <span class=\"string\">=</span> <span class=\"string\">&quot;dataset/train/ants_image/0013035.jpg&quot;</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">PIL</span> <span class=\"string\">import</span> <span class=\"string\">Image</span></span><br><span class=\"line\"><span class=\"string\">img</span> <span class=\"string\">=</span> <span class=\"string\">Image.open(image_path)</span></span><br><span class=\"line\"><span class=\"string\">print(type(img))</span> </span><br><span class=\"line\"><span class=\"string\">&lt;class</span> <span class=\"string\">&#x27;PIL.JpegImagePlugin.JpegImageFile&#x27;</span><span class=\"string\">&gt;</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<details><summary>img的类型不符合add_image</summary><div>\n<p>img_tensor (torch.Tensor, numpy.ndarray, or string/blobname): Image data</p>\n</div></details>\n<ul>\n<li>使用 opencv 读取图片，获得 numpy 型图片数据</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```终端</span></span><br><span class=\"line\"><span class=\"string\">pip</span> <span class=\"string\">install</span> <span class=\"string\">opencv-python</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">cv2</span></span><br><span class=\"line\"><span class=\"string\">cv_img</span> <span class=\"string\">=</span> <span class=\"string\">cv2.imread(img_path)</span></span><br><span class=\"line\"><span class=\"string\">print(type(cv_img))</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>利用 numpy.array ()，对 PIL 图片进行转换</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python控制台</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">numpy</span> <span class=\"string\">as</span> <span class=\"string\">np</span></span><br><span class=\"line\"><span class=\"string\">img_array</span> <span class=\"string\">=</span> <span class=\"string\">np.array(img)</span></span><br><span class=\"line\"><span class=\"string\">print(type(img_array))</span></span><br><span class=\"line\"><span class=\"string\">&lt;class</span> <span class=\"string\">&#x27;numpy.ndarray&#x27;</span><span class=\"string\">&gt;</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>实战</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">PIL</span> <span class=\"string\">import</span> <span class=\"string\">Image</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">numpy</span> <span class=\"string\">as</span> <span class=\"string\">np</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;log&quot;)</span></span><br><span class=\"line\"><span class=\"string\">img_path</span> <span class=\"string\">=</span> <span class=\"string\">&quot;dataset/train/bees_image/16838648_415acd9e3f.jpg&quot;</span></span><br><span class=\"line\"><span class=\"string\">img_PIL</span> <span class=\"string\">=</span> <span class=\"string\">Image.open(img_path)</span></span><br><span class=\"line\"><span class=\"string\">img_array</span> <span class=\"string\">=</span> <span class=\"string\">np.array(img_PIL)</span></span><br><span class=\"line\"><span class=\"string\">print(type(img_array))</span></span><br><span class=\"line\"><span class=\"string\">print(img_array.shape)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer.add_image(&quot;test&quot;,img_array,2,dataformats=&#x27;HWC&#x27;)</span></span><br><span class=\"line\"><span class=\"comment\"># y = 2x</span></span><br><span class=\"line\"><span class=\"attr\">for i in range(100):</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_scalar(tag=&quot;y=x&quot;,</span> <span class=\"string\">scalar_value=i,</span> <span class=\"string\">global_step=i)</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_scalar(tag=&quot;y=2x&quot;,</span> <span class=\"string\">scalar_value=2*i,</span> <span class=\"string\">global_step=i)#</span> <span class=\"string\">标题，数值（y轴），训练的步数（x轴）</span></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"常见的transforms\"><a class=\"markdownIt-Anchor\" href=\"#常见的transforms\">#</a> 常见的 Transforms</h1>\n<p>关注输入，输出和作用</p>\n<details class=\"success\"><summary>init__call__的作用</summary><div>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"attr\">class Person:</span></span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">__call__(self,name):</span></span><br><span class=\"line\">        <span class=\"string\">print(&quot;__call__&quot;+&quot;Helle&quot;+name)</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"string\">def</span> <span class=\"string\">hello(self,name):</span></span><br><span class=\"line\">        <span class=\"string\">print(&quot;hello&quot;+name)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">person</span> <span class=\"string\">=</span> <span class=\"string\">Person()</span></span><br><span class=\"line\"><span class=\"string\">person(&quot;张三&quot;)</span></span><br><span class=\"line\"><span class=\"string\">person.hello(&quot;lisi&quot;)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<p><span class=\"label\">例子</span></p>\n</div></details>\n<h2 id=\"对比\"><a class=\"markdownIt-Anchor\" href=\"#对比\">#</a> 对比</h2>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">PIL</span> <span class=\"string\">import</span> <span class=\"string\">Image</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torchvision</span> <span class=\"string\">import</span>  <span class=\"string\">transforms</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 相对路径</span></span><br><span class=\"line\"><span class=\"comment\"># PIL</span></span><br><span class=\"line\"><span class=\"string\">img_path</span> <span class=\"string\">=&quot;dataset/train/ants_image/0013035.jpg&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 绝对路径</span></span><br><span class=\"line\"><span class=\"comment\"># img_path_abs = r&quot;F:\\doc\\python\\1\\Learn-PyTorch\\dataset\\train\\ants_image\\0013035.jpg&quot;</span></span><br><span class=\"line\"><span class=\"string\">img</span> <span class=\"string\">=</span> <span class=\"string\">Image.open(img_path)</span></span><br><span class=\"line\"><span class=\"string\">print(type(img))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Tensor</span></span><br><span class=\"line\"><span class=\"string\">tensor_trans</span> <span class=\"string\">=</span> <span class=\"string\">transforms.ToTensor()</span></span><br><span class=\"line\"><span class=\"string\">tensor_img</span> <span class=\"string\">=</span> <span class=\"string\">tensor_trans(img)</span></span><br><span class=\"line\"><span class=\"string\">print(tensor_img)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<p>创建具体的工具 tensor_trans，使用这个具体的工具，给它一个输入 img，获得一个输出</p>\n<h2 id=\"transformstotensor\"><a class=\"markdownIt-Anchor\" href=\"#transformstotensor\">#</a> transforms.ToTensor</h2>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">PIL</span> <span class=\"string\">import</span> <span class=\"string\">Image</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torchvision</span> <span class=\"string\">import</span>  <span class=\"string\">transforms</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">cv2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">img_path</span> <span class=\"string\">=&quot;dataset/train/ants_image/0013035.jpg&quot;</span></span><br><span class=\"line\"><span class=\"string\">print(type(img))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">tensor_trans</span> <span class=\"string\">=</span> <span class=\"string\">transforms.ToTensor()</span></span><br><span class=\"line\"><span class=\"string\">tensor_img</span> <span class=\"string\">=</span> <span class=\"string\">tensor_trans(img)</span></span><br><span class=\"line\"><span class=\"string\">print(tensor_img)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;log&quot;)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer.add_image(&quot;Tensor_img&quot;,tensor_img)</span></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"topilimage\"><a class=\"markdownIt-Anchor\" href=\"#topilimage\">#</a> ToPILImage</h2>\n<p>作用：把数据转化为 PIL 的数据类型</p>\n<h2 id=\"normalize\"><a class=\"markdownIt-Anchor\" href=\"#normalize\">#</a> Normalize</h2>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">print(img_tensor[0][0][0])</span></span><br><span class=\"line\"><span class=\"string\">trans_norm</span> <span class=\"string\">=</span> <span class=\"string\">transforms.Normalize([0.5,0.5,0.5],[0.5,0.5,0.5])</span></span><br><span class=\"line\"><span class=\"comment\"># trans_norm只能输入tensor数据类型</span></span><br><span class=\"line\"><span class=\"string\">img_norm</span> <span class=\"string\">=</span> <span class=\"string\">trans_norm(img_tensor)</span></span><br><span class=\"line\"><span class=\"string\">print(img_norm[0][0][0])</span></span><br><span class=\"line\"><span class=\"string\">writer.add_image(&quot;Normalize&quot;,img_norm)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"resize\"><a class=\"markdownIt-Anchor\" href=\"#resize\">#</a> Resize</h2>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">print(img.size)</span></span><br><span class=\"line\"><span class=\"string\">trans_resize</span> <span class=\"string\">=</span> <span class=\"string\">transforms.Resize((512,512))</span></span><br><span class=\"line\"><span class=\"comment\"># 输入类型为PIL</span></span><br><span class=\"line\"><span class=\"string\">img_resize</span> <span class=\"string\">=</span> <span class=\"string\">trans_resize(img)</span></span><br><span class=\"line\"><span class=\"comment\"># 查看返回值类型，为PIL</span></span><br><span class=\"line\"><span class=\"string\">print(img_resize)</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将数据类型变为tensor</span></span><br><span class=\"line\"><span class=\"string\">img_resize</span> <span class=\"string\">=</span> <span class=\"string\">trans_totenser(img_resize)</span></span><br><span class=\"line\"><span class=\"string\">writer.add_image(&quot;Resize&quot;,img_resize,0)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"compose-resize等比缩放\"><a class=\"markdownIt-Anchor\" href=\"#compose-resize等比缩放\">#</a> Compose Resize（等比缩放）</h2>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```</span></span><br><span class=\"line\"><span class=\"string\">trans_resize_2</span> <span class=\"string\">=</span> <span class=\"string\">transforms.Resize(512)</span></span><br><span class=\"line\"><span class=\"comment\"># 后面参数的输入 和 前面参数的输出 进行匹配</span></span><br><span class=\"line\"><span class=\"string\">trans_compose</span> <span class=\"string\">=</span> <span class=\"string\">transforms.Compose([trans_resize_2,trans_totenser])</span></span><br><span class=\"line\"><span class=\"comment\"># 需要输入 PIL img</span></span><br><span class=\"line\"><span class=\"string\">img_resize_2</span> <span class=\"string\">=</span> <span class=\"string\">trans_compose(img)</span></span><br><span class=\"line\"><span class=\"string\">writer.add_image(&quot;Resize&quot;,img_resize_2,1)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"randomcrop\"><a class=\"markdownIt-Anchor\" href=\"#randomcrop\">#</a> RandomCrop</h2>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```</span></span><br><span class=\"line\"><span class=\"string\">trans_random</span> <span class=\"string\">=</span> <span class=\"string\">transforms.RandomCrop(333)</span></span><br><span class=\"line\"><span class=\"comment\"># 进行随机裁剪，然后转化为tenser类型</span></span><br><span class=\"line\"><span class=\"string\">trans_compose</span> <span class=\"string\">=</span> <span class=\"string\">transforms.Compose([trans_random,trans_totenser])</span></span><br><span class=\"line\"><span class=\"attr\">for i in range(10):</span></span><br><span class=\"line\">    <span class=\"string\">img_crop</span> <span class=\"string\">=</span> <span class=\"string\">trans_compose(img)</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_image(&quot;RandomCrop&quot;,img_crop,i)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"dataset和transforms的联合使用\"><a class=\"markdownIt-Anchor\" href=\"#dataset和transforms的联合使用\">#</a> dataset 和 transforms 的联合使用</h1>\n<ul>\n<li>下载数据集</li>\n</ul>\n<p>视频中相同的<span class=\"exturl\" data-url=\"aHR0cHM6Ly9weXRvcmNoLm9yZy92aXNpb24vMC45Lw==\">链接</span></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torchvision</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">train_set</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(root=&quot;./data&quot;,train=True,download=True)</span></span><br><span class=\"line\"><span class=\"string\">test_set</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(root=&quot;./data&quot;,train=False,download=True)</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<p>+++ 数据集<br>\n；；；<br>\n<span class=\"label success\">success</span></p>\n<div class=\"links\"><div class=\"item\" title=\"CIFAR10.zip\" style=\"--block-color:#e9546b;\"><span class=\"exturl image\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMU96LWphQlNEOHZrMVBmVHVjcXcwN3c/cHdkPTgyaWk=\" data-background-image=\"https://img.88icon.com/download/jpg/201912/20212877d98b95ae7730decb11762bac.jpg!bg\"></span>\n          <div class=\"info\">\n          <span class=\"exturl title\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMU96LWphQlNEOHZrMVBmVHVjcXcwN3c/cHdkPTgyaWk=\">CIFAR10.zip</span>\n          <p class=\"desc\">密码82ii</p>\n          </div></div></div>\n<p>;;;<br>\n+++</p>\n<ul>\n<li>联合使用</li>\n</ul>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torchvision</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">test_tb</span> <span class=\"string\">import</span> <span class=\"string\">writer</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">dataset_transform</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.transforms.Compose([</span></span><br><span class=\"line\">    <span class=\"string\">torchvision.transforms.ToTensor()</span></span><br><span class=\"line\"><span class=\"string\">])</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">train_set</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(root=&quot;/data&quot;,train=True,transform=dataset_transform,download=True)</span></span><br><span class=\"line\"><span class=\"string\">test_set</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(root=&quot;/data&quot;,train=False,transform=dataset_transform,download=True)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># print(test_set)</span></span><br><span class=\"line\"><span class=\"comment\"># print(test_set.classes)</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># img,target = test_set[0]</span></span><br><span class=\"line\"><span class=\"comment\"># print(img)</span></span><br><span class=\"line\"><span class=\"comment\"># print(target)</span></span><br><span class=\"line\"><span class=\"comment\"># print(test_set.classes[target])</span></span><br><span class=\"line\"><span class=\"comment\"># img.show()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># print(test_set[0])</span></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;p10&quot;)</span></span><br><span class=\"line\"><span class=\"attr\">for i in range(10):</span></span><br><span class=\"line\">    <span class=\"string\">img,target</span> <span class=\"string\">=</span> <span class=\"string\">train_set[i]</span></span><br><span class=\"line\">    <span class=\"string\">writer.add_image(&quot;test_set&quot;,img,i)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"dataloader的使用\"><a class=\"markdownIt-Anchor\" href=\"#dataloader的使用\">#</a> DataLoader 的使用</h1>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">```python</span></span><br><span class=\"line\"><span class=\"string\">import</span> <span class=\"string\">torchvision.datasets</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.data</span> <span class=\"string\">import</span> <span class=\"string\">DataLoader</span></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">torch.utils.tensorboard</span> <span class=\"string\">import</span> <span class=\"string\">SummaryWriter</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">from</span> <span class=\"string\">dataset_transform</span> <span class=\"string\">import</span> <span class=\"string\">test_set,</span> <span class=\"string\">writer</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">test_data</span> <span class=\"string\">=</span> <span class=\"string\">torchvision.datasets.CIFAR10(&quot;./data&quot;,</span> <span class=\"string\">train=False,transform=torchvision.transforms.ToTensor())</span></span><br><span class=\"line\"><span class=\"comment\"># 当batch_size不足64，drop_last=True将会舍去剩下的图片</span></span><br><span class=\"line\"><span class=\"comment\"># shuffle = False时两轮数据是相同的</span></span><br><span class=\"line\"><span class=\"string\">test_loader</span> <span class=\"string\">=</span> <span class=\"string\">DataLoader(dataset=test_set,</span> <span class=\"string\">batch_size=64,</span> <span class=\"string\">shuffle=False,</span> <span class=\"string\">num_workers=0,</span> <span class=\"string\">drop_last=True)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 测试数据集中的第一张图片及target</span></span><br><span class=\"line\"><span class=\"string\">img,target</span> <span class=\"string\">=</span> <span class=\"string\">test_data[0]</span></span><br><span class=\"line\"><span class=\"string\">print(img.shape)</span></span><br><span class=\"line\"><span class=\"string\">print(target)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer</span> <span class=\"string\">=</span> <span class=\"string\">SummaryWriter(&quot;dataloader&quot;)</span></span><br><span class=\"line\"><span class=\"string\">step</span> <span class=\"string\">=</span> <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 两轮</span></span><br><span class=\"line\"><span class=\"attr\">for epoch in range(2):</span></span><br><span class=\"line\">    <span class=\"attr\">for data in test_loader:</span></span><br><span class=\"line\">        <span class=\"string\">imgs,targets</span> <span class=\"string\">=</span> <span class=\"string\">data</span></span><br><span class=\"line\">        <span class=\"comment\"># print(imgs.shape)</span></span><br><span class=\"line\">        <span class=\"comment\"># print(targets)</span></span><br><span class=\"line\">        <span class=\"string\">writer.add_images(&quot;test_data_epoch_false&quot;,imgs,step)</span></span><br><span class=\"line\">        <span class=\"string\">step</span> <span class=\"string\">+=</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">writer.close()</span></span><br><span class=\"line\"><span class=\"string\">```</span></span><br></pre></td></tr></table></figure>",
            "tags": [
                "pytorch基础",
                "笔记"
            ]
        }
    ]
}